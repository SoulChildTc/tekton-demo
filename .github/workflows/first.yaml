name: 测试
run-name: 测试kubectl
on:
  push:
  #   paths:
  #   - 'additionalScrapeConfigs.yaml'
jobs:
  build:
    runs-on: ubuntu-latest
    container:
      image: bitnami/kubectl:1.26.1
    steps:
    - uses: actions/checkout@v3
    - name: generate-secret
      run: |-
        kubectl create secret -n monitoring generic additional-scrape-configs --from-file additionalScrapeConfigs.yaml --dry-run=client -o yaml > additionalScrapeConfigs.secret.yaml 
        git add .
        git commit -m "update prometheus config"
    - name: Push changes
      uses: ad-m/github-push-action@master
      with:
        branch: main
